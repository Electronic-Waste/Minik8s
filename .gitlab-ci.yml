stages:
  - test

cache:
  key: ${CI_BUILD_REF_NAME}
  paths:
    - bin/

test:
  stage: test
  only:
    - kubeadm
    - kubeadm-test
  script:
    # Set proxy for go
    - go env -w GO111MODULE=on
    - go env -w GOPROXY=https://goproxy.cn,direct
    # Run our testcases
    - go test ./cmd/kubeadm/app/cmd
    - go test ./pkg/util/json
    - go test ./pkg/util/yaml
  tags:
    - Minik8s